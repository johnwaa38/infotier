import { Injectable } from '@nestjs/common'; @Injectable() export class DecisionService { decide(p:{ ocrConf:number; matchScore:number; liveness:number; approve?:number; reject?:number }){ const approve=p.approve??0.75, reject=p.reject??0.35; const score=Number((p.ocrConf*0.4+p.matchScore*0.4+p.liveness*0.2).toFixed(4)); let status='manual_review', reason='Borderline score'; if(score>=approve){ status='approved'; reason='Confidence above approval threshold' } else if(score<reject){ status='rejected'; reason='Confidence below rejection threshold' } return { status, score, reason } } }
